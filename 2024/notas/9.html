<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>CS50x en Espa침ol</title>

    <!-- http://getbootstrap.com/docs/4.5/getting-started/introduction/ -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/popper.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>

    <!-- https://momentjs.com/, https://momentjs.com/timezone/ -->
    <script src="/static/js/moment.min.js"></script>
    <script src="/static/js/moment-timezone-with-data.min.js"></script>
    <script src="/static/js/luxon.min.js"></script>

    <!-- https://www.algolia.com/doc/guides/building-search-ui/installation/js/ -->
    <script src="/static/js/algoliasearchLite.min.js"></script>
    <script src="/static/js/instantsearch.production.min.js"></script>
    <script src="/static/js/jekyll-theme-cs50.js"></script>

    <script id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/static/highlight/highlight.min.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.8.0/dist/mermaid.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/static/highlight/styles/vs.min.css"/>
    <link rel="stylesheet" href="/static/css/page.css">

    <style>
      code {
        color: black;
        border: 1px solid #dee2e6;
      }

      pre > code {
        padding: 0 !important;
      }

      pre {
        border: 1px solid #dee2e6;
      }

      .mermaid {
        background-color: white !important;
        border: none !important;
      }
    </style>
  </head>

  <body>
    <!-- Markdown Flux Diagrams -->
    <script type="module">
      mermaid.initialize({startOnLoad: true});
    </script>
    <div class="container-fluid">
      <div class="row">
        <aside class="col-md" style="background-color: orangered">
  <header>
    <h1>
      <a href="">CS50x en Espa침ol</a>
    </h1>

    <p>
      <a target="_blank" href="">Curso de Introducci칩n a la Ciencia de la Computaci칩n de la Universidad de Harvard</a>
      <br/>
      2024
    </p>
  </header>

  <button class="btn btn-sm collapsed d-md-none" aria-controls="nav" aria-expanded="false" data-target="aside &gt; nav" data-toggle="collapse">
    Menu
  </button>

  <nav class="collapse d-md-block" id="nav">
    <hr/>

    <ul>
      <li>
        <a href="/2024/semanas/0.html">Semana
          0</a>
        Scratch 游떀
      </li>
      <li>
        <a href="/2024/semanas/1.html">Semana
          1</a>
        C
      </li>
      <li>
        <a href="/2024/semanas/2.html">Semana
          2</a>
        Arreglos
      </li>
      <li>
        <a href="/2024/semanas/3.html">Semana
          3</a>
        Algoritmos
      </li>
      <li>
        <a href="/2024/semanas/4.html">Semana
          4</a>
        Memoria
      </li>
      <li>
        <a href="/2024/semanas/5.html">Semana
          5</a>
        Estructuras de Datos
      </li>
      <li>
        <a href="/2024/semanas/6.html">Semana
          6</a>
        Python
      </li>
      <li>
        <a href="/2024/semanas/7.html">Semana
          7</a>
        SQL
      </li>
      <li>
        <a href="/2024/semanas/8.html">Semana
          8</a>
        HTML, CSS, JavaScript
      </li>
      <li>
        <a href="/2024/semanas/9.html">Semana
          9</a>
        Flask
      </li>
      <li>
        <a href="/2024/semanas/10.html">Semana
          10</a>
        Ciberseguridad
      </li>
    </ul>

    <hr/>

    <ul>
      <li>
        <a href="/2024/proyecto.html">Proyecto Final</a>
      </li>
    </ul>

    <hr/>

    <ul>
      <li>
        <a href="/2024/honestidad.html">Honestidad Acad칠mica</a>
      </li>
      <li>
        <a href="/2024/certificado.html">Certificado CS50</a>
      </li>
      <li>
        <a href="/2024/preguntas_frecuentes.html">Preguntas Frecuentes</a>
      </li>
      <li>
        <a href="https://cs50.me/cs50x">Libro de Calificaciones</a>
      </li>
      <li>
        <a href="/2024/personal.html">Equipo</a>
      </li>
      <li>
        <a href="/2024/plan_de_estudios.html">Programa del Curso</a>
      </li>
    </ul>
    <hr/>

    <ul>
      <li>
        <a href="/manual/index.html">Manual del Programador</a>
      </li>
      <li>
        <a href="/2024/estilo.html">Gu칤a de Estilo</a>
      </li>
    </ul>
  </nav>
</aside>
        <main class="col-md markdown-body">
          

  <h1>Clase 9</h1>
<ul>
<li><a href="#welcome">춰Bienvenidos!</a></li>
<li><a href="#static-to-dynamic">De est치tico a din치mico</a></li>
<li><a href="#flask">Flask</a></li>
<li><a href="#layout">Dise침o</a></li>
<li><a href="#post">POST</a></li>
<li><a href="#frosh-ims">Mensajes instant치neos de novatos</a></li>
<li><a href="#flask-and-sql">Flask y SQL</a></li>
<li><a href="#session">Sesi칩n</a></li>
<li><a href="#store">Almacenamiento</a></li>
<li><a href="#api">API</a></li>
<li><a href="#json">JSON</a></li>
<li><a href="#summing-up">Resumen</a></li>
</ul>
<h2>춰Bienvenidos!</h2>
<ul>
<li>En las semanas anteriores, aprendiste numerosos lenguajes de programaci칩n, t칠cnicas y estrategias.</li>
<li>De hecho, esta clase ha sido mucho menos una <em>clase de C</em> o <em>clase de Python</em> y mucho m치s una <em>clase de programaci칩n</em>, de tal manera que puedas seguir tendencias futuras.</li>
<li>En las 칰ltimas semanas, aprendiste <em>c칩mo aprender</em> sobre programaci칩n.</li>
<li>Hoy, pasaremos de HTML y CSS a combinar HTML, CSS, SQL, Python y JavaScript para que puedas crear tus propias aplicaciones web.</li>
</ul>
<h2>De est치tico a din치mico</h2>
<ul>
<li>Hasta este punto, todo el HTML que viste estaba preescrito y era est치tico.</li>
<li>En el pasado, cuando visitabas una p치gina, el navegador descargaba una p치gina HTML y pod칤as verla.</li>
<li>Las p치ginas din치micas se refieren a la capacidad de Python y lenguajes similares de crear archivos HTML al vuelo. Por consiguiente, puedes tener p치ginas web que se generan mediante opciones seleccionadas por tu usuario.</li>
<li>En el pasado, utilizaste <code>http-server</code> para alojar tus p치ginas web. Hoy, vamos a utilizar un servidor nuevo que puede analizar una direcci칩n web y realizar acciones seg칰n la URL proporcionada.</li>
</ul>
<h2>Flask</h2>
<ul>
<li><em>Flask</em> es una biblioteca de terceros que te permite alojar aplicaciones web utilizando el marco Flask dentro de Python.</li>
<li>Puedes ejecutar Flask mediante la ejecuci칩n de <code>flask run</code>.</li>
<li>Para hacerlo, necesitar치s un archivo llamado <code>app.py</code> y una carpeta llamada <code>templates</code>.</li>
<li>
<p>Para comenzar, crea una carpeta llamada <code>templates</code> y crea un archivo llamado <code>index.html</code> con el siguiente c칩digo:</p>
<pre><code>  &lt;!DOCTYPE html&gt;

  &lt;html lang="en"&gt;
      &lt;head&gt;
          &lt;meta name="viewport" content="initial-scale=1, width=device-width"&gt;
          &lt;title&gt;hello&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
          hello, {{ name }}
      &lt;/body&gt;
  &lt;/html&gt;
</code></pre>
</li>
<li>
<p>Observa el <code>{{ name }}</code> doble que es un marcador de posici칩n para algo que luego proporcionar치 nuestro servidor Flask.</p>
</li>
<li>
<p>Luego, en la misma carpeta donde aparece la carpeta <code>templates</code>, crea un archivo llamado <code>app.py</code> y agrega el siguiente c칩digo:</p>
<pre><code>  # Saluda al usuario

  from flask import Flask, render_template, request

  app = Flask(__name__)

  @app.route("/")
  def index():
      return render_template("index.html", name=request.args.get("name", "world"))
</code></pre>
</li>
<li>
<p>Observa que este c칩digo define <code>app</code> como la aplicaci칩n Flask. Luego, define la ruta <code>/</code> de <code>app</code> como el contenido de retorno de <code>index.html</code> con el argumento de <code>name</code>. De manera predeterminada, la funci칩n <code>request.args.get</code> buscar치 el <code>name</code> proporcionado por el usuario. Si no se proporciona ning칰n nombre, tomar치 "world" de manera predeterminada.</p>
</li>
<li>
<p>Finalmente, en la misma carpeta que "app.py", agrega un archivo final denominado "requirements.txt" que tiene solo una l칤nea de c칩digo:</p>
<pre><code>  Flask
</code></pre>
<p>Observa que solo "Flask" aparece en este archivo.</p>
</li>
<li>
<p>Puedes ejecutar este archivo ingresando "flask run" en la ventana de tu terminal. Si Flask no se ejecuta, aseg칰rate de que tu sintaxis sea correcta en cada uno de los archivos anteriores. Adem치s, si Flask no se ejecuta, aseg칰rate de que tus archivos est칠n organizados as칤:</p>
<pre><code>  /templates
      index.html
  app.py
  requirements.txt
</code></pre>
<p>Una vez que lo hagas funcionar, se te pedir치 que hagas clic en un enlace. Una vez que navegues a esa p치gina web, intenta agregar "?name=[Tu nombre]" a la URL base en la barra de URL de tu navegador.</p>
</li>
<li>
<p>Mejorando nuestro programa, sabemos que la mayor칤a de los usuarios no ingresar치n argumentos en la barra de direcciones. En cambio, los programadores conf칤an en que los usuarios completen formularios en las p치ginas web. En consecuencia, podemos modificar index.html de la siguiente manera:</p>
<pre><code>  &lt;!DOCTYPE html&gt;

  &lt;html lang="en"&gt;
      &lt;head&gt;
          &lt;meta name="viewport" content="initial-scale=1, width=device-width"&gt;
          &lt;title&gt;hello&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
          &lt;form action="/greet" method="get"&gt;
              &lt;input autocomplete="off" autofocus name="name" placeholder="Name" type="text"&gt;
              &lt;button type="submit"&gt;Greet&lt;/button&gt;
          &lt;/form&gt;
      &lt;/body&gt;
  &lt;/html&gt;
</code></pre>
<p>Observa que ahora se crea un formulario que toma el nombre del usuario y luego se lo entrega a una ruta denominada "/greet".</p>
</li>
<li>
<p>Adem치s, podemos cambiar "app.py" de la siguiente manera:</p>
<pre><code>  # Agrega un formulario, segunda ruta

  from flask import Flask, render_template, request

  app = Flask(__name__)

  @app.route("/")
  def index():
      return render_template("index.html")

  @app.route("/greet")
  def greet():
      name = request.args.get("name", "world")
      return render_template("greet.html", name=name)
</code></pre>
<p>Observa que la ruta predeterminada mostrar치 un formulario para que el usuario ingrese su nombre. La ruta "/greet" pasar치 el "nombre" a esa p치gina web.</p>
</li>
<li>
<p>Para finalizar esta implementaci칩n, necesitar치s otra plantilla para "greet.html" de la siguiente manera:</p>
<pre><code>  &lt;!DOCTYPE html&gt;

  &lt;html lang="en"&gt;
      &lt;head&gt;
          &lt;meta name="viewport" content="initial-scale=1, width=device-width"&gt;
          &lt;title&gt;hello&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
          hello, {{ name }}
      &lt;/body&gt;
  &lt;/html&gt;
</code></pre>
<p>Observa que esta ruta ahora mostrar치 el saludo al usuario, seguido de su nombre.</p>
</li>
</ul>
<h2>Presentaci칩n</h2>
<ul>
<li>Nuestras dos p치ginas web, <code>index.html</code> y <code>greet.html</code>, tienen muchos de los mismos datos. 쯅o ser칤a bueno permitir que el cuerpo sea 칰nico, pero copiar la misma presentaci칩n de una p치gina a otra?</li>
<li>
<p>Primero, cree una nueva plantilla llamada <code>layout.html</code> y escriba el c칩digo como se indica a continuaci칩n:</p>
<pre><code>  &lt;!DOCTYPE html&gt;

  &lt;html lang="en"&gt;
      &lt;head&gt;
          &lt;meta name="viewport" content="initial-scale=1, width=device-width"&gt;
          &lt;title&gt;hello&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
          {% block body %}{% endblock %}
      &lt;/body&gt;
  &lt;/html&gt;
</code></pre>
<p>Observe que <code>{% block body %}{% endblock %}</code> permite la inserci칩n de otro c칩digo desde otros archivos HTML.</p>
</li>
<li>
<p>A continuaci칩n, modifique su <code>index.html</code> de la siguiente manera:</p>
<pre><code>  {% extends "layout.html" %}

  {% block body %}

      &lt;form action="/greet" method="post"&gt;
          &lt;input autocomplete="off" autofocus name="name" placeholder="Name" type="text"&gt;
          &lt;button type="submit"&gt;Saludo&lt;/button&gt;
      &lt;/form&gt;

  {% endblock %}
</code></pre>
<p>Observe que la l칤nea <code>{% extends "layout.html" %}</code> le indica al servidor d칩nde obtener la presentaci칩n de esta p치gina. Entonces, <code>{% block body %}{% endblock %}</code> indica qu칠 c칩digo se insertar치 en <code>layout.html</code>.</p>
</li>
<li>
<p>Finalmente, cambie <code>greet.html</code> de la siguiente manera:</p>
<pre><code>  {% extends "layout.html" %}

  {% block body %}
      hola, {{ name }}
  {% endblock %}
</code></pre>
<p>Observe c칩mo este c칩digo es m치s corto y m치s compacto.</p>
</li>
</ul>
<h2>POST</h2>
<ul>
<li>Puedes imaginar situaciones en las que no es seguro utilizar <code>get</code> ya que los nombres de usuario y las contrase침as aparecer칤an en la URL.</li>
<li>
<p>Podemos usar el m칠todo <code>post</code> para solucionar este problema modificando <code>app.py</code> como se muestra a continuaci칩n:</p>
<pre><code>  # Cambia a POST

  from flask import Flask, render_template, request

  app = Flask(__name__)

  @app.route("/")
  def index():
      return render_template("index.html")

  @app.route("/greet", methods=["POST"])
  def greet():
      return render_template("greet.html", name=request.form.get("name", "world"))
</code></pre>
<p>Observa que <code>POST</code> se agrega a la ruta <code>/greet</code> y que usamos <code>request.form.get</code> en lugar de <code>request.args.get</code>.</p>
</li>
<li>
<p>Esto le indica al servidor que busque <em>m치s profundamente</em> en el sobre virtual y no revele los elementos en <code>post</code> en la URL.</p>
</li>
<li>
<p>A칰n as칤, este c칩digo puede mejorarse a칰n m치s utilizando una sola ruta para <code>get</code> y <code>post</code>. Para esto, modifica <code>app.py</code> como se muestra a continuaci칩n:</p>
<pre><code>  # Usa una sola ruta

  from flask import Flask, render_template, request

  app = Flask(__name__)

  @app.route("/", methods=["GET", "POST"])
  def index():
      if request.method == "POST":
          return render_template("greet.html", name=request.form.get("name", "world"))
      return render_template("index.html")
</code></pre>
<p>Observa que tanto <code>get</code> como <code>post</code> se realizan en un solo enrutamiento. Sin embargo, <code>request.method</code> se utiliza para enrutar correctamente seg칰n el tipo de enrutamiento solicitado por el usuario.</p>
</li>
</ul>
<h2>Los servicios de mensajer칤a instant치nea para los alumnos de primer a침o</h2>
<ul>
<li>Los servicios de mensajer칤a instant치nea para los alumnos de primer a침o o <em>froshims</em> es una aplicaci칩n web que permite a los estudiantes registrarse para deportes intramuros.</li>
<li>
<p>Crea una carpeta escribiendo <code>mkdir froshims</code> en la ventana de la terminal. Luego, escribe <code>cd froshims</code> para navegar a esta carpeta. Dentro, crea un directorio llamado templates escribiendo <code>mkdir templates</code>. Finalmente, escribe <code>code app.py</code> y escribe el c칩digo de la siguiente manera:</p>
<pre><code> # Implementa un formulario de registro utilizando un men칰 de selecci칩n

 de flask import Flask, render_template, request

 app = Flask(__name__)

 DEPORTES = [
     "Baloncesto",
     "F칰tbol",
     "Ultimate Frisbee"
 ]

 @app.route("/")
 def index():
     return render_template("index.html", sports=DEPORTES)

 @app.route("/register", methods=["POST"])
 def register():

     # Validar la aportaci칩n
     if not request.form.get("name") or request.form.get("sport") not in DEPORTES:
         return render_template("failure.html")

     # Confirmar el registro
     return render_template("success.html")
</code></pre>
<p>Observa que se proporciona una opci칩n de <code>failure</code> o fracaso, de modo que se mostrar치 un mensaje de fracaso al usuario si el campo <code>name</code> o <code>sport</code> no se rellenan correctamente.</p>
</li>
<li>
<p>A continuaci칩n, crea un archivo en la carpeta <code>templates</code> llamado <code>index.html</code> escribiendo <code>code templates/index.html</code> y escribe el c칩digo de la siguiente manera:</p>
<pre><code>  {% extends "layout.html" %}

  {% block body %}
      &lt;h1&gt;Registro&lt;/h1&gt;
      &lt;form action="/register" method="post"&gt;
          &lt;input autocomplete="off" autofocus name="name" placeholder="Nombre" type="text"&gt;
          &lt;select name="sport"&gt;
              &lt;option disabled selected&gt;Deporte&lt;/option&gt;
              {% for sport in sports %}
                  &lt;option value="{{ sport }}"&gt;{{ sport }}&lt;/option&gt;
              {% endfor %}
          &lt;/select&gt;
          &lt;button type="submit"&gt;Registrar&lt;/button&gt;
      &lt;/form&gt;
  {% endblock %}
</code></pre>
</li>
<li>
<p>A continuaci칩n, crea un archivo llamado <code>layout.html</code> escribiendo <code>code templates/layout.html</code> y escribe el c칩digo de la siguiente manera:</p>
<pre><code>  &lt;!DOCTYPE html&gt;

  &lt;html lang="en"&gt;
      &lt;head&gt;
          &lt;meta name="viewport" content="initial-scale=1, width=device-width"&gt;
          &lt;title&gt;froshims&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
          {% block body %}{% endblock %}
      &lt;/body&gt;
  &lt;/html&gt;
</code></pre>
</li>
<li>
<p>En cuarto lugar, crea un archivo en las plantillas llamado <code>success.html</code> de la siguiente manera:</p>
<pre><code>  {% extends "layout.html" %}

  {% block body %}
      춰Est치s registrado!
  {% endblock %}
</code></pre>
</li>
<li>
<p>Finalmente, crea un archivo en las plantillas llamado <code>failure.html</code> de la siguiente manera:</p>
<pre><code>  {% extends "layout.html" %}

  {% block body %}
      춰No est치s registrado!
  {% endblock %}
</code></pre>
</li>
<li>
<p>Puedes imaginar c칩mo podr칤amos querer aceptar el registro de muchos registrantes diferentes. Podemos mejorar <code>app.py</code> de la siguiente manera:</p>
<pre><code>  # Implementa un formulario de registro, almacenando registrantes en un diccionario, con mensajes de error

  de flask importar Flask, redirigir, render_template, solicitar

  app = Flask(__name__)

  REGISTRANTES = {}

  DEPORTES = [
      "Basquetbol",
      "F칰tbol",
      'Ultimate Frisbee'
  ]

  @app.route("/")
  def index():
      return render_template("index.html", deportes = DEPORTES)

  @app.route("/registro", m칠todos=["POST"])
  def registrarse():

      # Validar nombre
      nombre = request.form.get("nombre")
      if not nombre:
          return render_template("error.html", mensaje="Falta nombre")

      # Validar deporte
      deporte = request.form.get("deporte")
      si no deporte:
          return render_template("error.html", mensaje="Falta nombre")
      si el deporte no est치 en DEPORTES:
          return render_template("error.html", mensaje="Deporte inv치lido")

      # Recordar registrante
      REGISTRANTES[nombre] = deporte

      # Confirmar registro
      return redireccionar("/registrantes")

  @app.route("/registrantes")
  def registrantes():
      return render_template("registrantes.html", registrantes=REGISTRANTES)
</code></pre>
<p>Nota que se utiliza un diccionario llamado <code>REGISTRANTES</code> para registrar el <code>deporte</code> seleccionado por <code>REGISTRANTES[nombre]</code>. Adem치s, observa que <code>registrantes=REGISTRANTES</code> pasa el diccionario a esta plantilla.</p>
</li>
<li>
<p>Adem치s, crea una nueva plantilla llamada <code>registrantes.html</code> de la siguiente manera:</p>
<pre><code>  {% extiende "layout.html" %}

  {% bloque cuerpo %}
      &lt;h1&gt;Registrantes&lt;/h1&gt;
      &lt;table&gt;
          &lt;thead&gt;
              &lt;tr&gt;
                  &lt;th&gt;Nombre&lt;/th&gt;
                  &lt;th&gt;Deporte&lt;/th&gt;
              &lt;/tr&gt;
          &lt;/thead&gt;
          &lt;tbody&gt;
              {% para nombre en registrantes %}
                  &lt;tr&gt;
                      &lt;td&gt;{{ nombre }}&lt;/td&gt;
                      &lt;td&gt;{{ registrantes[nombre] }}&lt;/td&gt;
                  &lt;/tr&gt;
              {% endfor %}
          &lt;/tbody&gt;
      &lt;/table&gt;
  {% endblock %}
</code></pre>
<p>Ten en cuenta que <code>{% para nombre en registrantes %}...{% endfor %}</code> iterar치 por cada uno de los registrantes. 춰Muy poderoso para poder iterar en una p치gina web din치mica!</p>
</li>
<li>
<p>Ejecutando <code>flask run</code> y entrando varios nombres y deportes, puedes navegar a <code>/registrantes</code> para ver qu칠 datos se han registrado.</p>
</li>
<li>춰Ahora tienes una aplicaci칩n web! Sin embargo, 춰hay algunas fallas de seguridad! Debido a que todo est치 en el lado del cliente, un adversario podr칤a cambiar el HTML y hackear un sitio web. Adem치s, estos datos no persistir치n si el servidor se apaga. 쯇odr칤a haber alguna forma de que nuestros datos pudieran persistir incluso cuando el servidor se reinicie?</li>
</ul>
<h2>Flask y SQL</h2>
<ul>
<li>As칤 como hemos visto c칩mo Python puede interactuar con una base de datos SQL, podemos combinar el poder de Flask, Python y SQL para crear una aplicaci칩n web 춰donde los datos persistir치n!</li>
<li>Para implementar esto, necesitar치s seguir varios pasos.</li>
<li>
<p>Primero, modificar <code>requirements.txt</code> de la siguiente manera:</p>
<pre><code>  cs50
  Flask
</code></pre>
</li>
<li>
<p>Modifica <code>index.html</code> de la siguiente manera:</p>
<pre><code>  {% extends "layout.html" %}

  {% block body %}
      &lt;h1&gt;Registrarse&lt;/h1&gt;
      &lt;form action="/register" method="post"&gt;
          &lt;input autocomplete="off" autofocus name="name" placeholder="Nombre" type="text"&gt;
          {% for sport in sports %}
              &lt;input name="sport" type="radio" value="{{ sport }}"&gt; {{ sport }}
          {% endfor %}
          &lt;button type="submit"&gt;Registrar&lt;/button&gt;
      &lt;/form&gt;
  {% endblock %}
</code></pre>
</li>
<li>
<p>Modifica <code>layout.html</code> de la siguiente manera:</p>
<pre><code>  &lt;!DOCTYPE html&gt;

  &lt;html lang="en"&gt;
      &lt;head&gt;
          &lt;meta name="viewport" content="initial-scale=1, width=device-width"&gt;
          &lt;title&gt;froshims&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
          {% block body %}{% endblock %}
      &lt;/body&gt;
  &lt;/html&gt;
</code></pre>
</li>
<li>
<p>Aseg칰rate de que <code>failure.html</code> aparezca de la siguiente manera:</p>
<pre><code>  {% extends "layout.html" %}

  {% block body %}
      춰No est치s registrado!
  {% endblock %}
</code></pre>
</li>
<li>
<p>Modifica <code>registrants.html</code> para que aparezca de la siguiente manera:</p>
<pre><code>  {% extends "layout.html" %}

  {% block body %}
      &lt;h1&gt;Registrados&lt;/h1&gt;
      &lt;table&gt;
          &lt;thead&gt;
              &lt;tr&gt;
                  &lt;th&gt;Nombre&lt;/th&gt;
                  &lt;th&gt;Deporte&lt;/th&gt;
                  &lt;th&gt;&lt;/th&gt;
              &lt;/tr&gt;
          &lt;/thead&gt;
          &lt;tbody&gt;
              {% for registrant in registrants %}
                  &lt;tr&gt;
                      &lt;td&gt;{{ registrant.name }}&lt;/td&gt;
                      &lt;td&gt;{{ registrant.sport }}&lt;/td&gt;
                      &lt;td&gt;
                          &lt;form action="/deregister" method="post"&gt;
                              &lt;input name="id" type="hidden" value="{{ registrant.id }}"&gt;
                              &lt;button type="submit"&gt;Eliminar registro&lt;/button&gt;
                          &lt;/form&gt;
                      &lt;/td&gt;
                  &lt;/tr&gt;
              {% endfor %}
          &lt;/tbody&gt;
      &lt;/table&gt;
  {% endblock %}
</code></pre>
</li>
<li>
<p>Observa que se incluye un valor oculto <code>registrant.id</code> de manera que sea posible utilizar este <code>id</code> m치s adelante en <code>app.py</code></p>
</li>
<li>
<p>Finalmente, modifica <code>app.py</code> de la siguiente manera:</p>
<pre><code>  # Implementa un formulario de registro, almacenando a los registrados en una base de datos de SQLite, con soporte para la cancelaci칩n del registro

  from cs50 import SQL
  from flask import Flask, redirect, render_template, request

  app = Flask(__name__)

  db = SQL("sqlite:///froshims.db")

  SPORTS = [
      "Basquetbol",
      "F칰tbol",
      "Ultimate Frisbee"
  ]

  @app.route("/")
  def index():
      return render_template("index.html", sports=SPORTS)

  @app.route("/deregister", methods=["POST"])
  def deregister():

      # Olvidar al registrado
      id = request.form.get("id")
      if id:
          db.execute("DELETE FROM registrants WHERE id = ?", id)
      return redirect("/registrants")

  @app.route("/register", methods=["POST"])
  def register():

      # Validar el env칤o
      name = request.form.get("name")
      sport = request.form.get("sport")
      if not name or sport not in SPORTS:
          return render_template("failure.html")

      # Recordar al registrado
      db.execute("INSERT INTO registrants (name, sport) VALUES(?, ?)", name, sport)

      # Confirmar el registro
      return redirect("/registrants")

  @app.route("/registrants")
  def registrants():
      registrants = db.execute("SELECT * FROM registrants")
      return render_template("registrants.html", registrants=registrants)
</code></pre>
<p>Ten en cuenta que se utiliza la librer칤a <code>cs50</code>. Se incluye una ruta para <code>register</code> para el m칠todo <code>post</code>. Esta ruta tomar치 el nombre y el deporte tomados del formulario de registro y ejecutar치 una consulta SQL para agregar el <code>nombre</code> y el <code>deporte</code> a la tabla <code>registrants</code>. La ruta <code>deregister</code> va a una consulta SQL que tomar치 el <code>id</code> del usuario y utilizar치 esa informaci칩n para cancelar el registro de esta persona.</p>
</li>
<li>
<p>Puedes leer m치s en la <a href="https://flask.palletsprojects.com">documentaci칩n de Flask</a>.</p>
</li>
</ul>
<h2>Sesi칩n</h2>
<ul>
<li>Si bien el c칩digo anterior es 칰til desde un punto de vista administrativo, donde un administrador de la oficina interna podr칤a agregar y eliminar personas de la base de datos, uno puede imaginarse c칩mo este c칩digo no es seguro de implementar en un servidor p칰blico.</li>
<li>Por un lado, los actores malintencionados podr칤an tomar decisiones en nombre de otros usuarios presionando el bot칩n de anulaci칩n del registro, eliminando efectivamente su respuesta grabada del servidor.</li>
<li>Los servicios web como Google utilizan credenciales de inicio de sesi칩n para garantizar que los usuarios solo tengan acceso a los datos correctos.</li>
<li>En realidad, podemos implementar esto usando <em>cookies</em>. Las cookies son peque침os archivos que se almacenan en su computadora, de modo que su computadora puede comunicarse con el servidor y decir efectivamente: "Soy un usuario autorizado que ya ha iniciado sesi칩n".</li>
<li>En la forma m치s simple, podemos implementar esto creando una carpeta llamada <code>login</code> y luego agregando los siguientes archivos.</li>
<li>Primero, crea un archivo llamado <code>requirements.txt</code> que se lee de la siguiente manera:<pre><code>  Flask
  Flask-Session
</code></pre>
</li>
</ul>
<p>Tenga en cuenta que adem치s de <code>Flask</code>, tambi칠n incluimos <code>Flask-Session</code>, que es necesario para admitir sesiones de inicio de sesi칩n.</p>
<ul>
<li>En segundo lugar, en una carpeta <code>templates</code>, crea un archivo llamado <code>layout.html</code> que aparece de la siguiente manera:<pre><code>  &lt;!DOCTYPE html&gt;

  &lt;html lang="en"&gt;
      &lt;head&gt;
          &lt;meta name="viewport" content="initial-scale=1, width=device-width"&gt;
          &lt;title&gt;store&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
          {% block body %}{% endblock %}
      &lt;/body&gt;
  &lt;/html&gt;
</code></pre>
</li>
</ul>
<p>Tenga en cuenta que esto proporciona un dise침o muy simple con un t칤tulo y un cuerpo.</p>
<ul>
<li>En tercer lugar, crea un archivo en la carpeta <code>templates</code> llamado <code>index.html</code> que aparece de la siguiente manera:<pre><code>  {% extends "layout.html" %}

  {% block body %}

      {% if session["name"] %}
          Has iniciado sesi칩n como {{ session["name"] }}. &lt;a href="/logout"&gt;Cerrar sesi칩n&lt;/a&gt;.
      {% else %}
          No has iniciado sesi칩n. &lt;a href="/login"&gt;Iniciar sesi칩n&lt;/a&gt;.
      {% endif %}

  {% endblock %}
</code></pre>
</li>
</ul>
<p>Tenga en cuenta que este archivo busca ver si existe <code>session["name"]</code>. Si es as칤, mostrar치 un mensaje de bienvenida. De lo contrario, te recomendar치 navegar a una p치gina para iniciar sesi칩n.</p>
<ul>
<li>
<p>En cuarto lugar, crea un archivo llamado <code>login.html</code> y agrega el siguiente c칩digo:</p>
<pre><code>  {% extends "layout.html" %}

  {% block body %}

      &lt;form action="/login" method="post"&gt;
          &lt;input autocomplete="off" autofocus name="name" placeholder="Nombre" type="text"&gt;
          &lt;button type="submit"&gt;Iniciar sesi칩n&lt;/button&gt;
      &lt;/form&gt;

  {% endblock %}
</code></pre>
<p>Observa que este es el dise침o de una p치gina de inicio de sesi칩n b치sica.</p>
</li>
<li>
<p>Finalmente, crea un archivo en la carpeta <code>login</code> llamado <code>app.py</code> y escribe el c칩digo de la siguiente manera:</p>
<pre><code>  from flask import Flask, redirect, render_template, request, session
  from flask_session import Session

  # Configura la aplicaci칩n
  app = Flask(__name__)

  # Configura la sesi칩n
  app.config["SESSION_PERMANENT"] = False
  app.config["SESSION_TYPE"] = "filesystem"
  Session(app)

  @app.route("/")
  def index():
      if not session.get("name"):
          return redirect("/login")
      return render_template("index.html")

  @app.route("/login", methods=["GET", "POST"])
  def login():
      if request.method == "POST":
          session["name"] = request.form.get("name")
          return redirect("/")
      return render_template("login.html")

  @app.route("/logout")
  def logout():
      session["name"] = None
      return redirect("/")
</code></pre>
<p>Observa las <em>importaciones</em> modificadas en la parte superior del archivo, incluyendo <code>session</code>, que te permitir치 usar sesiones. Lo m치s importante, observa c칩mo se usa <code>session["name"]</code> en las rutas <code>login</code> y <code>logout</code>. La ruta <code>login</code> asignar치 el nombre de inicio de sesi칩n proporcionado y lo asignar치 a <code>session["name"]</code>. Sin embargo, en la ruta <code>logout</code>, el cierre de sesi칩n se implementa simplemente configurando <code>session["name"]</code> a <code>None</code>.</p>
</li>
<li>
<p>Puedes leer m치s sobre sesiones en la <a href="https://flask.palletsprojects.com/en/2.2.x/api/?highlight=session#flask.session">documentaci칩n de Flask</a>.</p>
</li>
</ul>
<h2>Tienda</h2>
<ul>
<li>Pasemos a un ejemplo final de utilizar la capacidad de Flask para habilitar una sesi칩n.</li>
<li>
<p>Examinamos el siguiente c칩digo para <code>store</code> en <code>app.py</code>. Se mostr칩 el siguiente c칩digo:</p>
<pre><code>  from cs50 import SQL
  from flask import Flask, redirect, render_template, request, session
  from flask_session import Session

  # Configure app
  app = Flask(__name__)

  # Connect to database
  db = SQL("sqlite:///store.db")

  # Configure session
  app.config["SESSION_PERMANENT"] = False
  app.config["SESSION_TYPE"] = "filesystem"
  Session(app)

  @app.route("/")
  def index():
      books = db.execute("SELECT * FROM books")
      return render_template("books.html", books=books)

  @app.route("/cart", methods=["GET", "POST"])
  def cart():

      # Ensure cart exists
      if "cart" not in session:
          session["cart"] = []

      # POST
      if request.method == "POST":
          id = request.form.get("id")
          if id:
              session["cart"].append(id)
          return redirect("/cart")

      # GET
      books = db.execute("SELECT * FROM books WHERE id IN (?)", session["cart"])
      return render_template("cart.html", books=books)
</code></pre>
<p>Tenga en cuenta que <code>cart</code> se implementa utilizando una lista. Se pueden agregar elementos a esta lista utilizando los botones <code>Agregar al carrito</code> en <code>books.html</code>. Al hacer clic en dicho bot칩n, se invoca el m칠todo <code>post</code>, donde el <code>id</code> del elemento se agrega al <code>cart</code>. Al ver el carrito, al invocar el m칠todo <code>get</code>, SQL se ejecuta para mostrar una lista de los libros en el carrito.</p>
</li>
</ul>
<h2>API</h2>
<ul>
<li>Una <em>interfaz de programa de aplicaci칩n</em> o <em>API</em> es una serie de especificaciones que te permiten interactuar con otros servicios. Por ejemplo, podr칤amos utilizar la API de IMDB para interactuar con su base de datos. Incluso podr칤amos integrar API para manejar tipos espec칤ficos de datos descargables desde un servidor.</li>
<li>Vimos un ejemplo denominado <code>shows</code>.</li>
<li>
<p>Al ver <code>app.py</code>, encontramos lo siguiente:</p>
<pre><code>  # Busca programas usando Ajax

  from cs50 import SQL
  from flask import Flask, render_template, request

  app = Flask(__name__)

  db = SQL("sqlite:///shows.db")

  @app.route("/")
  def index():
      return render_template("index.html")

  @app.route("/search")
  def search():
      q = request.args.get("q")
      if q:
          shows = db.execute("SELECT * FROM shows WHERE title LIKE ? LIMIT 50", "%" + q + "%")
      else:
          shows = []
      return render_template("search.html", shows=shows)
</code></pre>
<p>Ten en cuenta que la ruta <code>search</code> ejecuta una consulta SQL.</p>
</li>
<li>
<p>Al ver <code>search.html</code>, notar치s que es muy simple:</p>
<pre><code>  {% for show in shows %}
      &lt;li&gt;{{ show["title"] }}&lt;/li&gt;
  {% endfor %}
</code></pre>
<p>Ten en cuenta que proporciona una lista con vi침etas.</p>
</li>
<li>
<p>Finalmente, al ver <code>index.html</code>, ten en cuenta que se utiliza el c칩digo <em>AJAX</em> para impulsar la b칰squeda:</p>
<pre><code>  &lt;!DOCTYPE html&gt;

  &lt;html lang="en"&gt;
      &lt;head&gt;
          &lt;meta name="viewport" content="initial-scale=1, width=device-width"&gt;
          &lt;title&gt;shows&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;

          &lt;input autocomplete="off" autofocus placeholder="Query" type="search"&gt;

          &lt;ul&gt;&lt;/ul&gt;

          &lt;script&gt;

              let input = document.querySelector('input');
              input.addEventListener('input', async function() {
                  let response = await fetch('/search?q=' + input.value);
                  let shows = await response.text();
                  document.querySelector('ul').innerHTML = shows;
              });

          &lt;/script&gt;

      &lt;/body&gt;
  &lt;/html&gt;
</code></pre>
</li>
</ul>
<p>Ten en cuenta que se utiliza un detector de eventos para consultar el servidor de forma din치mica y proporcionar una lista que coincida con el t칤tulo provisto. Esto ubicar치 la etiqueta <code>ul</code> en el HTML y modificar치 la p치gina web seg칰n corresponda para incluir la lista de coincidencias.</p>
<ul>
<li>Puedes obtener m치s informaci칩n en la <a href="https://api.jquery.com/category/ajax/">Documentaci칩n de AJAX</a>.</li>
</ul>
<h2>JSON</h2>
<ul>
<li>_ JavaScript Object Notation_ o _ JSON_ es un archivo de texto de diccionarios con claves y valores. Esta es una forma cruda y f치cil de usar para las computadoras de obtener muchos datos.</li>
<li>JSON es una forma muy 칰til de obtener datos del servidor.</li>
<li>Puedes ver esto en acci칩n en el <code>칤ndice.html</code> que examinamos juntos:<pre><code>  &lt;!DOCTYPE html&gt;

  &lt;html lang="en"&gt;
      &lt;head&gt;
          &lt;meta name="viewport" content="initial-scale=1, width=device-width"&gt;
          &lt;title&gt;shows&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;

          &lt;input autocomplete="off" autofocus placeholder="Query" type="text"&gt;

          &lt;ul&gt;&lt;/ul&gt;

          &lt;script&gt;

              let input = document.querySelector('input');
              input.addEventListener('input', async function() {
                  let response = await fetch('/search?q=' + input.value);
                  let shows = await response.json();
                  let html = '';
                  for (let id in shows) {
                      let title = shows[id].title.replace('&lt;', '&amp;lt;').replace('&amp;', '&amp;amp;');
                      html += '&lt;li&gt;' + title + '&lt;/li&gt;';
                  }
                  document.querySelector('ul').innerHTML = html;
              });

          &lt;/script&gt;

      &lt;/body&gt;
  &lt;/html&gt;
</code></pre>
</li>
</ul>
<p>Si bien lo anterior puede ser algo cr칤ptico, te proporciona un punto de partida para que investigues JSON por tu cuenta y veas c칩mo se puede implementar en tus propias aplicaciones web.</p>
<ul>
<li>Puedes leer m치s en la <a href="https://www.json.org/json-en.html">documentaci칩n de JSON</a>.</li>
</ul>
<h2>Resumen</h2>
<p>En esta lecci칩n, aprendiste a utilizar Python, SQL y Flask para crear aplicaciones web. En concreto, hemos hablado de...</p>
<ul>
<li>GET</li>
<li>POST</li>
<li>Flask</li>
<li>Session</li>
<li>AJAX</li>
<li>JSON</li>
</ul>
<p>춰Hasta la pr칩xima para nuestra conferencia final!</p>


        </main>
      </div>
    </div>
  </body>

</html>